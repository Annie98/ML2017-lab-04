# ML2017-lab-04

## 实验目的
* 1.探索推荐系统的搭建过程
* 2.理解矩阵分解的原理
* 3.熟练对梯度下降的运用
* 4.在简单小规模数据集上实现推荐系统，培养工程能力

## 数据集描述

* 1.采用MovieLens-100k数据集
* 2.u.data -- 由943个用户对1682个电影的10000条评分组成。每个用户至少评分20部电影。用户和电影从1号开始连续编号。数据是随机排序的。
* 3. 数据集u1.base / u1.test到u5.base / u5.test都是将u.data数据集按照80% / 20%的比例分割的训练集和测试集。 
* 4. 也可按照自己的评估方法划分训练集和验证集。

## 实验步骤

本次实验代码及画图均在jupyter上完成。

利用交替最小二乘法优化
* 1.读取数据，并划分数据集（或直接用u1.base/u1.test到u5.base/u5.test）。根据原始数据填充原始评分矩阵，对于空值可以填充为零。
* 2.初始化用户因子矩阵和物品（电影）因子矩阵，其中为潜在特征数。
* 3.确定损失函数和确定超参数η惩罚系数lambda。
* 4.利用交替最小二乘法分解稀疏的用户评分矩阵，得到用户因子矩阵和物品（电影）因子矩阵：   
4.1 固定物品因子矩阵求损失函数对用户因子矩阵的每一行（列）求偏导数，令偏导数为零更新用户因子矩阵。   
4.2 固定用户因子矩阵求损失函数对物品因子矩阵的每一行（列）求偏导数，令偏导数为零更新物品因子矩阵。    
4.3 计算在验证集上的L_vaildation，可与上一次迭代的L_vaildation比较判断是否收敛。
* 5.重复步骤4若干次，得到满意的用户因子矩阵和物品因子矩阵，画出L_vaildation随迭代次数变化的曲线图。
* 6.将用户因子矩阵与物品因子矩阵的转置相乘即可得到最终的评分预测矩阵。   

整理实验结果并完成实验报告。
